import{d as E,r as d,o as M,a as r,c as S,w as V,b as j,u as q,Z as F,e,f as n,t as u,g as x,h as k,F as h,i as w,v as C,j as P,k as _,N}from"./app-BkwNIxsC.js";import{_ as $}from"./NavbarLayout-DnD_pdoA.js";import{u as D}from"./blogStore-CyWXGYxl.js";/* empty css            */const U={class:"container mx-auto px-4 py-8"},z={class:"overflow-x-auto"},L={key:0,role:"alert",class:"alert alert-error"},Z={key:1,role:"alert",class:"alert alert-success"},G={class:"table"},H=["onClick"],I={key:0,class:"text-success"},J={key:1,class:"text-error"},K={id:"new_article_modal",class:"modal"},O={class:"modal-box"},Q={class:"flex justify-around"},R={class:"m-4"},W={class:"m-4"},X=["value"],Y={id:"new_category_modal",class:"modal"},ee={class:"modal-box"},te={class:"m-4"},ne=E({__name:"BlogEditor",setup(le){const y=D(),b=d([]),c=d([]),m=d({}),v=d(""),p=d(""),o=d(""),g=d("");M(async()=>{b.value=await y.fetchPosts(),c.value=await y.fetchCategories()});function A(s){N.visit(`/admin/edit-post/${s.id}`)}async function B(){var s,t,l;try{if(!v.value||!m.value.id){o.value="A title and category are required for a new article.",setTimeout(()=>{o.value=""},3e3);return}const a={title:v.value,category_id:m.value.id,content:"# New Blog Post",published:!1},i=await _.post("/api/posts",a);if(i.data.success)console.log("Article created:",i.data),N.visit(`/admin/edit-post/${i.data.data.id}`);else throw new Error(i.data.message||"Failed to create article")}catch(a){console.error("Error creating article:",((s=a.response)==null?void 0:s.data)||a),o.value=((l=(t=a.response)==null?void 0:t.data)==null?void 0:l.message)||a.message||"Failed to create article",setTimeout(()=>{o.value=""},3e3)}}async function T(){try{if(!p.value){o.value="A category name is required.",setTimeout(()=>{o.value=""},3e3);return}const s=await _.post("/api/categories",{name:p.value});if(s.data.success)console.log("Category created:",s.data),g.value="Category Successfully Created",c.value.push(s.data.data),setTimeout(()=>{g.value=""},3e3);else throw new Error(s.data.message)}catch(s){console.error("Error creating category:",s),o.value=s.message,setTimeout(()=>{o.value=""},3e3)}}return(s,t)=>(r(),S($,null,{default:V(()=>[j(q(F),{title:"Blog Editor"}),e("div",U,[e("div",z,[o.value?(r(),n("div",L,[t[3]||(t[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,u(o.value),1)])):x("",!0),g.value?(r(),n("div",Z,[t[4]||(t[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,u(g.value),1)])):x("",!0),t[6]||(t[6]=e("div",{class:"flex justify-between"},[e("h2",{class:"text-4xl font-bold my-6"},"Articles"),e("div",{class:"flex"},[e("button",{class:"btn btn-primary btn-sm my-6",onclick:"new_article_modal.showModal()"}," New Article "),e("button",{class:"btn btn-secondary btn-sm my-6 mx-2",onclick:"new_category_modal.showModal()"}," New Category ")])],-1)),e("table",G,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th"),e("th",null,"Title"),e("th",null,"Status"),e("th",null,"Category")])],-1)),e("tbody",null,[(r(!0),n(h,null,k(b.value,(l,a)=>{var i;return r(),n("tr",{class:"hover cursor-pointer",key:a,onClick:f=>A(l)},[e("th",null,u(a+1),1),e("td",null,u(l.title),1),l.published?(r(),n("td",I,"Published")):(r(),n("td",J,"Draft")),e("td",null,u((i=c.value.find(f=>f.id==l.category_id))==null?void 0:i.name),1)],8,H)}),128))])])]),e("dialog",K,[e("div",O,[t[12]||(t[12]=e("h3",{class:"text-lg font-bold text-center"},"Create Article",-1)),e("div",Q,[e("div",R,[t[7]||(t[7]=e("label",{for:"title-modal"},"Title",-1)),t[8]||(t[8]=e("br",null,null,-1)),w(e("input",{id:"title-modal",type:"text",placeholder:"New Article Title",class:"input input-bordered input-sm max-w-xs mt-2","onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),required:""},null,512),[[C,v.value]])]),e("div",W,[t[9]||(t[9]=e("label",{for:"category-modal"},"Category",-1)),t[10]||(t[10]=e("br",null,null,-1)),w(e("select",{id:"category-modal",type:"text",placeholder:"New Article Title",class:"select select-bordered select-sm max-w-xs mt-2","onUpdate:modelValue":t[1]||(t[1]=l=>m.value=l),required:""},[(r(!0),n(h,null,k(c.value,l=>(r(),n("option",{key:l.id,value:l},u(l.name),9,X))),128))],512),[[P,m.value]])])]),e("div",{class:"modal-action"},[e("form",{method:"dialog"},[t[11]||(t[11]=e("button",{class:"btn btn-error mx-2"},"Cancel",-1)),e("button",{class:"btn btn-primary",onClick:B}," Create ")])])])]),e("dialog",Y,[e("div",ee,[t[16]||(t[16]=e("h3",{class:"text-lg font-bold"},"New Category",-1)),e("div",te,[t[13]||(t[13]=e("label",{for:"title-modal"},"Name",-1)),t[14]||(t[14]=e("br",null,null,-1)),w(e("input",{id:"title-modal",type:"text",placeholder:"New Category Name",class:"input input-bordered input-sm max-w-xs mt-2","onUpdate:modelValue":t[2]||(t[2]=l=>p.value=l),required:""},null,512),[[C,p.value]])]),e("div",{class:"modal-action"},[e("form",{method:"dialog"},[t[15]||(t[15]=e("button",{class:"btn btn-error mx-2"},"Cancel",-1)),e("button",{class:"btn btn-primary",onClick:T}," Create ")])])])])])]),_:1}))}});export{ne as default};
